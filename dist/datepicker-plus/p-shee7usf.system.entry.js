System.register(["./p-1e3096bb.system.js"],function(e){"use strict";var t,n,r;return{setters:[function(e){t=e.h;n=e.r;r=e.c}],execute:function(){var a=function(e){var t=e.getFullYear();var n=e.getMonth();var r=n+1;var a=e.getDate();return t+"-"+r+"-"+a};var i=function(e){var t=new Date(e);t.setDate(t.getDate()+1);return a(t)};var s=function(){var e=new Date;var t=new Date(e.getFullYear(),e.getMonth(),1);var n=new Date(e.getFullYear(),e.getMonth()+1,0);return[a(t),a(n)]};var o=function(e,t){if(e===t)return[];var n=u([e,t]),r=n[0],a=n[1];var s=[];var o=i(r);while(o!==a){if(s.length>3e3)p({title:"Memory leak @ utils.unfoldRange()",label:"bug",body:JSON.stringify({dateString0:e,dateString1:t},null,2)});s.push(o);o=i(o)}return[r].concat(s,[a])};var u=function(e){var t=e[0],n=e[1];var r=new Date(t);var a=new Date(n);return r.valueOf()-a.valueOf()>0?[n,t]:[t,n]};var l=function(e,t){return Math.ceil((e.getTime()-t.getTime())/864e5)};var c=function(e,t){if(e===void 0){e=[]}return t.map(function(t,n){return e[n]||t})};var h=function(e){var t=Object.create({sorted:{years:[],months:{}},toArray:function(){var e=this;var t=[];this.sorted.years.forEach(function(n){var r=Object.values(e[n]);if(r.length)t=t.concat(r)});return t}});e.forEach(function(e){var n=new Date(e);var r=n.getFullYear(),a=n.getMonth()+1;if(t.hasOwnProperty(r)===false){t[r]={};t.sorted.years.push(r)}if(t[r].hasOwnProperty(a)===false){t[r][a]=[];if(t.sorted.months.hasOwnProperty(r)){t.sorted.months[r].push(a)}else{t.sorted.months[r]=[a]}}t[r][a].push(e)});t.sorted.years=t.sorted.years.sort(function(e,t){return e-t});for(var n in t.sorted.months){t.sorted.months[n]=t.sorted.months[n].sort(function(e,t){return e-t})}return t};var d=function(e){var t=new Date(e);return isNaN(t.getDate())?false:true};var f=function(e){var t=[];var n=[];e.forEach(function(e){if(e.dayOfWeek===6){t.push(e);n.push(t);t=[]}else{t.push(e)}});if(t.length){n.push(t)}return n};var g=function(e,t){var n=new Date(e);var r=n.getDate();n.setDate(r-t);var i=new Date(e);var s=i.getDate();i.setDate(s+t);return[n,i].map(function(e){return a(e)})};var p=function(e){var t=e.title,n=e.body,r=e.label;var a="title="+encodeURIComponent(t);var i="labels="+encodeURIComponent(r);var s="body="+encodeURIComponent(n);throw"Stopped to prevent memory leak.\n\nüêû Create a new issue:\n"+("https://github.com/solomancode/datepicker-plus/issues/new?"+i+"&"+a+"&"+s)};var v=[{name:"Sunday",abbr:"Sun",isWeekend:true},{name:"Monday",abbr:"Mon "},{name:"Tuesday",abbr:"Tue"},{name:"Wednesday",abbr:"Wed"},{name:"Thursday",abbr:"Thu"},{name:"Friday",abbr:"Fri"},{name:"Saturday",abbr:"Sat",isWeekend:true}];var m=[{name:"January",abbr:"Jan"},{name:"February",abbr:"Feb"},{name:"March",abbr:"Mar"},{name:"April",abbr:"Apr"},{name:"May",abbr:"May"},{name:"June",abbr:"Jun"},{name:"July",abbr:"Jul"},{name:"August",abbr:"Aug"},{name:"September",abbr:"Sep"},{name:"October",abbr:"Oct"},{name:"November",abbr:"Nov"},{name:"December",abbr:"Dec"}];var b={day:"day",year:"year",disabled:"disabled",selected:"selected",month:"month",months:"months",monthName:"month-name",monthHeader:"month-header",monthContent:"month-content",week:"week",empty:"empty",weekHeader:"week-header",weekContent:"week-content",weekend:"weekend",checkbox:"checkbox",singleHeader:"single-header",highlight:"highlight"};var y={selectMode:"range",selected:[],disabled:[],selectScopeSize:0,weekHeader:"per-month",viewRange:s(),i18n:{months:m,weekDays:v},layout:"vertical"};var D=function(e){return l(new Date(e),new Date)};var w=function(e){return D(e.dateString)===0};var k=function(e){return D(e.dateString)===1};var E=function(e){return D(e.dateString)===-1};var S=function(e){return D(e.dateString)<0};var A=function(e){return D(e.dateString)>0};var M=function(e){var t=e.getAttr("rangeIndex")===0;return t};var C=function(e){var t=e.getAttr("rangeIndex");var n=e.getAttr("rangeEndIndex");return n>0&&t===n};var O=function(e){return e.getAttr("rangeIndex")>0&&e.getAttr("rangeEndIndex")!==e.getAttr("rangeIndex")};var x={today:w,rangeStart:M,rangeEnd:C,connector:O,tomorrow:k,yesterday:E,past:S,future:A};var R=function(){function e(e){this.dateString=e;this.pendingQueue=[];this.attributes={};this.date=new Date(e);this.day=this.date.getDate();this.month=this.date.getMonth()+1;this.year=this.date.getFullYear();this.dayOfWeek=this.date.getDay();this.updateAttributes(x)}e.prototype.hookDOMElement=function(e){var t=this;if(e instanceof HTMLTimeElement){this.DateDOMElement=e}else if(e instanceof HTMLInputElement){this.checkboxDOMElement=e}this.pendingQueue=this.pendingQueue.filter(function(e){return e.call(t)===false})};e.prototype.updateDateClasses=function(){var e=this;if(this.DateDOMElement){this.DateDOMElement.setAttribute("class",b.day+" "+Object.keys(this.attributes).filter(function(t){return e.attributes[t]===true}).join(" "));return true}else{this.pendingQueue.push(this.updateDateClasses)}return true};e.prototype.updateCheckboxAttribute=function(e,t){var n=this;if(this.checkboxDOMElement){this.checkboxDOMElement[e]=t}else{this.pendingQueue.push(function(){if(!n.checkboxDOMElement)return false;n.checkboxDOMElement[e]=t;n.updateDateClasses();return true})}this.updateDateClasses()};e.prototype.updateDOMAttribute=function(e,t){if(e==="checked"||e==="disabled"){this.updateCheckboxAttribute(e,t)}this.updateDateClasses()};e.prototype.setAttr=function(e,t){this.attributes[e]=t;this.updateDOMAttribute(e,t)};e.prototype.getAttr=function(e){return this.attributes[e]};e.prototype.hasAttr=function(e){return e in this.attributes};e.prototype.removeAttr=function(e){delete this.attributes[e];this.updateDateClasses()};e.prototype.resetRangeAttributes=function(){this.removeAttr("rangeIndex");this.removeAttr("rangeEndIndex");this.removeAttr("rangeStart");this.removeAttr("rangeEnd");this.removeAttr("connector")};e.prototype.updateAttributes=function(e){for(var t in e){if(e.hasOwnProperty(t)){var n=e[t];if(n(this)===true){this.setAttr(t,true)}}}};return e}();function H(e){var n=this;var r=function(t){return t.target.checked?n.select(e.dateString):n.deselect([e.dateString])};var a=function(){return e.getAttr("disabled")===false&&n.highlightON(e.dateString)};return t("time",{part:"day",dateTime:e.dateString,onMouseEnter:a.bind(this),ref:function(t){return e.hookDOMElement(t)}},t("label",null,e.day,t("input",{ref:function(t){return e.hookDOMElement(t)},onChange:r.bind(this),class:b.checkbox,type:"checkbox",value:e.dateString})))}function I(e){return t("header",{class:b.weekHeader,part:"week-header"},e.map(function(e){var n=e.name,r=e.abbr,a=e.isWeekend;return t("abbr",{class:a&&b.weekend,title:n},r)}))}function T(e){var n=[];while(e){n.push(t("span",{class:b.empty}));e--}return n}function W(e,n,r){return t("section",{part:"week",class:b.week},n&&I(r),t("section",{class:b.weekContent},T(e[0].dayOfWeek),e.map(H.bind(this)),T(6-e[e.length-1].dayOfWeek)))}function L(e,n){return t("header",{class:b.monthHeader,part:"month-header"},t("span",{class:b.monthName},n[e.month-1].name),e.month-1===0&&t("span",{class:b.year},e.year))}function N(e,n){var r=this;var a=n.layout==="horizontal"?{width:window.innerWidth-60+"px"}:{};var i=function(e){return n.weekHeader==="per-month"&&e===0};return t("section",{style:a,part:"month",class:b.month},L(e[0],n.i18n.months),t("section",{class:b.monthContent},f(e).map(function(e,t){return W.call(r,e,i(t),n.i18n.weekDays)})))}function F(e,n){var r=this;var a=n.layout==="horizontal"?{width:window.innerWidth*e.length+"px"}:{};var i=function(){return n.weekHeader==="single"&&t("header",{class:b.singleHeader},I(n.i18n.weekDays))};return[n.stylesheetUrl?t("link",{rel:"stylesheet",type:"text/css",href:n.stylesheetUrl}):null,t("section",{class:(n.stylesheetUrl?"":"dpp ")+n.layout,part:"dpp-container"},t("section",{style:a,class:"viewport"},[i()||null,e.map(function(e){return N.call(r,e,n)})]))]}var j=function(){function e(e){var t=this;n(this,e);this.plusConfig=y;this.dateRegistry={};this.viewElements=[];this.selected=[];this.disabled=[];this.highlighted=[];this.activeScope=null;this.unfoldDateStringList=function(e){if(!e.length)return[];return e.map(function(e){return d(e)?[e]:t.unfoldAttribute(e)}).reduce(function(e,t){return e.concat(t)})};this.patchConfigLists=function(){var e=y.i18n,n=e.months,r=e.weekDays;var a=t.plusConfig.i18n,i=a.months,s=a.weekDays;t.plusConfig.i18n.months=c(i,n);t.plusConfig.i18n.weekDays=c(s,r)};this.select=function(e){var n=t.plusConfig.selectMode;var r=[];if(n==="single"){r=[e]}else if(n==="multiple"){r=t.selected.concat([e])}else if(n==="range"){if(t.selected.includes(e)){r=[]}else if(t.selected.length===1){r=o(t.selected[0],e)}else{r=[e]}}var a=t.checkIfHasDisabled(r,t.disabled);if(a)return t.viewElements;var i=t.plusConfig.selectScopeSize;if(n==="range"&&i>0){if(!t.activeScope){t.activeScope=t.generateScope(t.disabled);t.activeScope.activate(e,i)}else{t.activeScope.deactivate()}}t.deselect(t.selected);t.selectMultipleDates(r);t.onDateSelect.emit(t.selected);if(n==="range"&&t.selected.length>1)t.onRangeSelect.emit(t.selected)};this.deselect=function(e){var n=t.plusConfig.selectMode;if(n==="range"){e=t.selected;if(t.activeScope&&e.length===1)t.activeScope.deactivate()}e.forEach(function(e){var r=t.getDateElement(e);r.setAttr("checked",false);if(n==="range"){r.resetRangeAttributes()}r.updateDateClasses()});t.selected=t.selected.filter(function(t){return!e.includes(t)});t.clearHighlighted()};this.getDateElement=function(e){return t.dateRegistry[e]};this.unfoldAttribute=function(e){var n=[];t.viewElements.reduce(function(e,t){return e.concat(t)}).forEach(function(t){if(t.getAttr(e)){n.push(t.dateString)}});return n};this.registerDate=function(e){if(e in t.dateRegistry)return t.dateRegistry[e];var n=new R(e);t.dateRegistry[e]=n;return n};this.onDateSelect=r(this,"onDateSelect",7);this.onDateDeselect=r(this,"onDateDeselect",7);this.onRangeSelect=r(this,"onRangeSelect",7)}e.prototype.componentWillLoad=function(){this.plusConfig=Object.assign({},y,this.plusConfig);this.patchConfigLists();if(this.plusConfig.layout==="horizontal"){this.plusConfig.weekHeader="per-month"}};e.prototype.componentDidLoad=function(){var e=this;var t=this.unfoldViewRange(this.plusConfig.viewRange);var n=t.map(function(t){return t.map(e.registerDate)});this.viewElements=n;var r=this.unfoldDateStringList(this.plusConfig.disabled);this.disableMultipleDates(r);this.plusConfig.selected.forEach(this.select)};e.prototype.unfoldViewRange=function(e){var t=e[0],n=e[1];var r=o(t,n);return h(r).toArray()};e.prototype.generateScope=function(e){var t=this;return{activate:function(e,n){var r=g(e,n),a=r[0],i=r[1];var s=t.plusConfig.viewRange,u=s[0],l=s[1];var c=o(u,a).concat(o(i,l));t.disableMultipleDates(c)},deactivate:function(){t.enableMultipleDates(t.disabled);t.disableMultipleDates(e);t.activeScope=null}}};e.prototype.highlightON=function(e){var t=this;if(this.plusConfig.selectMode==="range"&&this.selected.length===1){this.clearHighlighted();this.highlighted=o(this.selected[0],e);this.highlighted.forEach(function(e){var n=t.getDateElement(e);n.setAttr("highlighted",true)})}};e.prototype.clearHighlighted=function(){var e=this;this.highlighted.forEach(function(t){var n=e.getDateElement(t);if(n)n.removeAttr("highlighted")});this.highlighted=[]};e.prototype.checkIfHasDisabled=function(e,t){var n={};t.forEach(function(e){return n[e]=true});return e.some(function(e){return e in n})};e.prototype.selectMultipleDates=function(e){var t=this;e.forEach(function(n){var r=t.getDateElement(n);if(!r)return;r.setAttr("checked",true);if(e.length>1){var a=r.getAttr("checked");r.setAttr("rangeIndex",a?e.indexOf(r.dateString):null);r.setAttr("rangeEndIndex",a?e.length-1:null)}if(t.plusConfig.selectMode==="range"){var i=x.rangeStart,s=x.rangeEnd,o=x.connector;r.updateAttributes({rangeStart:i,rangeEnd:s,connector:o})}});this.selected=e};e.prototype.disableMultipleDates=function(e){var t=this;this.disabled=e.filter(function(e){var n=t.getDateElement(e);if(!n)return false;n.setAttr("disabled",true);return true})};e.prototype.enableMultipleDates=function(e){var t=this;e.forEach(function(e){var n=t.getDateElement(e);if(!n)return;n.setAttr("disabled",false)});this.disabled=this.disabled.filter(function(t){return!e.includes(t)})};e.prototype.render=function(){console.count("RENDER...");return F.call(this,this.viewElements,this.plusConfig)};Object.defineProperty(e,"style",{get:function(){return".dpp{font-family:monospace}.horizontal{overflow-x:scroll}.horizontal .month{display:inline-block}.month{border:1px solid #ccc;padding:20px}.dpp .month-header{text-transform:uppercase;font-weight:700;margin-bottom:5px}.dpp .day.checked.rangeStart{background-color:#cddc39}.dpp .day.checked.rangeEnd{background-color:#ff9800}.week-header{display:-ms-flexbox;display:flex}.single-header{padding:5px 20px}.week-header abbr{-ms-flex-positive:1;flex-grow:1;text-align:center}.week-content{display:-ms-flexbox;display:flex}.week-content>.day,.week-content>.empty{-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:80px;flex-basis:80px;text-align:center}.day{position:relative;line-height:30px}.day>label{display:block;width:100%;height:100%;cursor:pointer;-webkit-box-sizing:border-box;box-sizing:border-box}.day.disabled{color:#ccc;background-color:#f8f8f8}.dpp .day.checked,.dpp .day.highlighted{background-color:gold}.dpp .day.today{outline:1px solid #ccc}.checkbox{display:none}.month-header{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}"},enumerable:true,configurable:true});return e}();e("datepicker_plus",j)}}});